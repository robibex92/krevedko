-- Создание таблиц для контента сайта

-- Таблица SiteContent
CREATE TABLE IF NOT EXISTS "SiteContent" (
  "id" SERIAL PRIMARY KEY,
  "key" VARCHAR UNIQUE NOT NULL,
  "title" VARCHAR NOT NULL,
  "content" TEXT NOT NULL,
  "isActive" BOOLEAN DEFAULT true,
  "createdAt" TIMESTAMP DEFAULT NOW(),
  "updatedAt" TIMESTAMP DEFAULT NOW()
);

-- Таблица FAQItem
CREATE TABLE IF NOT EXISTS "FAQItem" (
  "id" SERIAL PRIMARY KEY,
  "question" VARCHAR NOT NULL,
  "answer" TEXT NOT NULL,
  "order" INTEGER DEFAULT 0,
  "isActive" BOOLEAN DEFAULT true,
  "createdAt" TIMESTAMP DEFAULT NOW(),
  "updatedAt" TIMESTAMP DEFAULT NOW()
);

-- Создание индексов
CREATE INDEX IF NOT EXISTS "SiteContent_key_idx" ON "SiteContent"("key");
CREATE INDEX IF NOT EXISTS "SiteContent_isActive_idx" ON "SiteContent"("isActive");
CREATE INDEX IF NOT EXISTS "FAQItem_order_idx" ON "FAQItem"("order");
CREATE INDEX IF NOT EXISTS "FAQItem_isActive_idx" ON "FAQItem"("isActive");

-- Вставка начальных данных
INSERT INTO "SiteContent" ("key", "title", "content", "isActive") VALUES
('about', 'О нас', 'Мы — команда «Ля Креведко», объединяющая поставщиков фермерских продуктов, владельцев локальных производств и клиентов, которые ценят свежесть и честный состав.

Каждую неделю мы собираем предзаказы, выезжаем к нашим партнёрам и доставляем вам продукты напрямую, минуя длительные цепочки поставок.

• Только проверенные производители и личное общение с каждым;
• Прозрачные цены без скрытых наценок и посредников;
• Гибкие периоды заказов и возможность оформить доставку заранее.', true),
('contacts', 'Контакты', 'Мы всегда на связи. Задавайте вопросы и отправляйте пожелания любым удобным способом.

Телефон: +7 999 000-00-00
Email: hello@lya-krevedko.ru
Telegram: @lya_krevedko

Мы находимся в г. Новосибирск, ул. Тайгинская, 37, но доставляем заказы и по области.', true)
ON CONFLICT ("key") DO NOTHING;

-- Вставка FAQ данных
INSERT INTO "FAQItem" ("question", "answer", "order", "isActive") VALUES
('Как оформить заказ?', 'Выберите товары в каталоге, добавьте их в корзину и нажмите «Оформить заказ». Выберите подходящий период сбора заказов. После подтверждения заказа вы получите уведомление на email и в Telegram (если подключен).', 1, true),
('Когда нужно оплатить заказ?', 'Оплата производится после подтверждения наличия товаров. Вы получите уведомление с реквизитами для оплаты и сможете загрузить квитанцию об оплате прямо в личном кабинете.', 2, true),
('Можно ли изменить или отменить заказ?', 'Да! В течение активного периода сбора заказов вы можете изменить количество товаров в корзине или отменить заказ полностью. После окончания периода изменения возможны только через обращение к администратору.', 3, true),
('Как работает доставка?', 'Доставка доступна при заказе от 3000 ₽ в пределах Новосибирска и области. Для заказов на меньшую сумму доступен самовывоз из наших точек выдачи. Стоимость доставки рассчитывается индивидуально.', 4, true),
('Что такое периоды сбора заказов?', 'Мы работаем по системе предзаказов. Каждую неделю открывается новый период сбора заказов, в течение которого вы можете оформить заказ. После закрытия периода мы формируем закупки у поставщиков и доставляем товары.', 5, true),
('Какие преимущества у зарегистрированных пользователей?', 'Зарегистрированные пользователи получают историю заказов, могут отслеживать статус доставки, получать уведомления о новых товарах и специальных предложениях.', 6, true)
ON CONFLICT DO NOTHING;
